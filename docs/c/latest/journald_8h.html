<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>stumpless: target/journald.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">stumpless
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_1bbcb9615bce09de8292fb64e7b04403.html">target</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">journald.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;<a class="el" href="config_8h_source.html">stumpless/config.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="entry_8h_source.html">stumpless/entry.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="target_8h_source.html">stumpless/target.h</a>&gt;</code><br />
</div>
<p><a href="journald_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab75ff5a64537d94a604cc00bac37861a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="journald_8h.html#ab75ff5a64537d94a604cc00bac37861a">__attribute__</a> ((visibility(&quot;default&quot;))) void stumpless_close_journald_target(const struct <a class="el" href="structstumpless__target.html">stumpless_target</a> *target)</td></tr>
<tr class="memdesc:ab75ff5a64537d94a604cc00bac37861a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes a journald target.  <a href="journald_8h.html#ab75ff5a64537d94a604cc00bac37861a">More...</a><br /></td></tr>
<tr class="separator:ab75ff5a64537d94a604cc00bac37861a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5955d0480797829083f892fa0088d378"><td class="memItemLeft" align="right" valign="top"><a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="journald_8h.html#a5955d0480797829083f892fa0088d378">element_index</a></td></tr>
<tr class="separator:a5955d0480797829083f892fa0088d378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e909a55b7e5a0b4887372324a595cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="journald_8h.html#ad6e909a55b7e5a0b4887372324a595cc">destination</a></td></tr>
<tr class="separator:ad6e909a55b7e5a0b4887372324a595cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6837099587860e983606ba8fc960066e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> char <a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="journald_8h.html#a6837099587860e983606ba8fc960066e">size</a></td></tr>
<tr class="separator:a6837099587860e983606ba8fc960066e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab56d638ecaf218130feae1222363f941"><td class="memItemLeft" align="right" valign="top"><a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> <a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="journald_8h.html#ab56d638ecaf218130feae1222363f941">param_index</a></td></tr>
<tr class="separator:ab56d638ecaf218130feae1222363f941"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Journald targets send messages to a systemd journald service.</p>
<p>Journald supports structured logging but does not use the same hierarchy as RFC 5424, instead providing a simple key/value pairing. To compensate for this these targets perform a number of transformations to map the elements and params into the flat hierarchy. By default element and param names are converted to uppercase and are joined together using underscores, but this behavior can be customized as needed.</p>
<p>Because RFC 5424 allows most printable ASCII characters while journald only allows letters and numbers, incompatible characters of the generated field name will be replaced with an underscore to comply with journald requirements.</p>
<p><b>Thread Safety: MT-Safe</b> Logging to journald targets is thread safe.</p>
<p><b>Async Signal Safety: AS-Unsafe</b> Logging to journald targets is not signal safe.</p>
<p><b>Async Cancel Safety: AC-Unsafe</b> Logging to journald targets is not async cancellation safe as it relies on sd_journal_sendv which is not documented as such. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab75ff5a64537d94a604cc00bac37861a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab75ff5a64537d94a604cc00bac37861a">&#9670;&nbsp;</a></span>__attribute__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__attribute__ </td>
          <td>(</td>
          <td class="paramtype">(visibility(&quot;default&quot;))&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a journald target. </p>
<p>Gets the string representation of the given severity.</p>
<p>Gets the string representation of the given facility.</p>
<p>Retrieves the error encountered by the last library call.</p>
<p>Opens a journald target.</p>
<p>Creates a name for the param by combining the element and param name.</p>
<p>Creates a journald-compliant name for the element.</p>
<p><b>Thread Safety: MT-Unsafe</b> This function is not thread safe as it destroys resources that other threads would use if they tried to reference this target.</p>
<p><b>Async Signal Safety: AS-Unsafe heap</b> This function is not safe to call from signal handlers due to the use of the memory deallocation function to release memory.</p>
<p><b>Async Cancel Safety: AC-Unsafe heap</b> This function is not safe to call from threads that may be asynchronously cancelled, as the memory deallocation function may not be AC-Safe itself.</p>
<dl class="section since"><dt>Since</dt><dd>v2.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The journald target to close.</td></tr>
  </table>
  </dd>
</dl>
<p>All lower case letters are converted to upper case. Characters that are not alphanumeric are replaced with an underscore character. This includes any UTF-8 characters.</p>
<p>If the destination buffer is too small to hold the complete name, then nothing is done. Callers can detect this by comparing the return value to the value provided in the size argument. If the return value is larger, then nothing was done.</p>
<p><b>Thread Safety: MT-Unsafe</b> This function is not thread safe. It reads fields of the entry and element without any synchronization.</p>
<p><b>Async Signal Safety: AS-Safe</b> This function is safe to call from signal handlers.</p>
<p><b>Async Cancel Safety: AC-Safe</b> This function is safe to call from threads that may be asynchronously cancelled.</p>
<dl class="section since"><dt>Since</dt><dd>v2.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>The entry that the param is part of.</td></tr>
    <tr><td class="paramname">element_index</td><td>The index of the element in the entry.</td></tr>
    <tr><td class="paramname">destination</td><td>The buffer to write the name to.</td></tr>
    <tr><td class="paramname">size</td><td>The maximum number of bytes to write to the destination buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes needed to write the complete flattened name, not including a NULL terminating character. If this is greater than size, then it signifies that nothing was done.</dd></dl>
<p>Both names are converted to all upper case and combined with an underscore character between them.</p>
<p>Characters that are not alphanumeric are replaced with an underscore character. This includes any UTF-8 characters.</p>
<p>If the destination buffer is too small to hold the complete name, then nothing is done. Callers can detect this by comparing the return value to the value provided in the size argument. If the return value is larger, then nothing was done by the call.</p>
<p><b>Thread Safety: MT-Unsafe</b> This function is not thread safe. It reads fields of the entry, element, and param without any synchronization.</p>
<p><b>Async Signal Safety: AS-Safe</b> This function is safe to call from signal handlers.</p>
<p><b>Async Cancel Safety: AC-Safe</b> This function is safe to call from threads that may be asynchronously cancelled.</p>
<dl class="section since"><dt>Since</dt><dd>v2.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>The entry that the param is part of.</td></tr>
    <tr><td class="paramname">element_index</td><td>The index of the element the param is part of.</td></tr>
    <tr><td class="paramname">param_index</td><td>The index of the param within the element.</td></tr>
    <tr><td class="paramname">destination</td><td>The buffer to write the name to.</td></tr>
    <tr><td class="paramname">size</td><td>The maximum number of bytes to write to the destination buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes needed to write the complete flattened name, not including a NULL terminating character. If this is greater than size, then it signifies that nothing was done.</dd></dl>
<p>This target will send log entries to the local service.</p>
<p><b>Thread Safety: MT-Safe race:name</b> This function is thread safe, of course assuming that name is not modified by any other threads during execution.</p>
<p><b>Async Signal Safety: AS-Unsafe heap</b> This function is not safe to call from signal handlers due to the use of memory allocation functions.</p>
<p><b>Async Cancel Safety: AC-Unsafe heap</b> This function is not safe to call from threads that may be asynchronously cancelled, as the memory allocation function may not be AC-Safe itself.</p>
<dl class="section since"><dt>Since</dt><dd>v2.1.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the logging target.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The opened target if no error is encountered. In the event of an error, NULL is returned and an error code is set appropriately. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad6e909a55b7e5a0b4887372324a595cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6e909a55b7e5a0b4887372324a595cc">&#9670;&nbsp;</a></span>destination</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * destination</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5955d0480797829083f892fa0088d378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5955d0480797829083f892fa0088d378">&#9670;&nbsp;</a></span>element_index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> element_index</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab56d638ecaf218130feae1222363f941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab56d638ecaf218130feae1222363f941">&#9670;&nbsp;</a></span>param_index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> <a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> param_index</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6837099587860e983606ba8fc960066e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6837099587860e983606ba8fc960066e">&#9670;&nbsp;</a></span>size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> <a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> char <a class="el" href="memory_8h.html#a1de1ad716e56455dd12745e3f014b642">size_t</a> size</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Oct 10 2022 21:47:45 for stumpless by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.19
</small></address>
</body>
</html>
